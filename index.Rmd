---
title: "Corvettes"
author: "Alexis Jeter"
date: '2022-06-11'
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(dplyr)
library(tidyr)
library(scales)
```

## Corvettes

## Corvettes Dataset
Importing the dataset. NOTE: This assumes that your Corvette.xlsx is in the same directory as the RMD file.
``` {r corvettes}
corvettes <- read_excel("Corvette.xlsx")
str(corvettes)
```
## Finding Missing Data
Displaying the column names which are missing data and the count of missing data.
``` {r corvettes_columns, echo=FALSE}
missingValues <- which(colSums(is.na(corvettes))>0)
knitr::kable(missingValues, col.names = c('Missing Values'))
```
### Engines
I'm interested in the unique engines in this list for question 2. 
``` {r corvettes_engines}
unique(corvettes$Engine)
```
### Color & Interior 
#### Color

``` {r corvettes_color, echo=FALSE}
corvettesOriginalColor <- unique(corvettes$Color)
colorsList <- data.frame(
  id=(1:6),
  colorfam_1=c("Blue","Teal","Purple","-","-","-"),
  colorfam_2=c("Red","Maroon","Burgundy","Ruby Red","-","-"),
  colorfam_3=c("Black","Black Rose","-","-","-","-"),
  colorfam_4=c("Brown","Buckskin","Silver Beige","Tan","Gold","Bronze"),
  colorfam_5=c("Yellow","Orange","-","-","-","-"),
  colorfam_6=c("Silver","Gray","Silver Pearl","White","-","-"),
  colorfam_7=c("Green","-","-","-","-","-")
  )
knitr::kable(corvettesOriginalColor, col.names = "Colors")
knitr::kable(colorsList)
```
#### Interior
``` {r corvettes_interior, echo=FALSE}
corvettesOriginalInterior <- unique(corvettes$Interior)
interiorsList <- data.frame(
  id=(1:6),
  intfam_1=c("Oyster", "Silver", "Gray", "Grey", "White", "-"),
  intfam_2=c("Black", "-", "-", "-", "-", "-"),
  intfam_3=c("Brown", "Tan", "Camel", "Tobacco", "Silver Beige", "Saddle"),
  intfam_4=c("Red", "Ruby Red", "-", "-", "-", "-"),
  intfam_5=c("Blue", "-", "-", "-", "-", "-"),
  intfam_6=c("Blue/White", "Yellow/Black", "Red/Black", "-", "-", "-"),
  intfam_7=c("Green", "-", "-", "-", "-", "-")
  )
knitr::kable(corvettesOriginalInterior, col.names = "Interiors")
knitr::kable(interiorsList)
```
## Blank Rows
### Transmissions
```{r corvettes_trans, echo=FALSE}
corvetteTransmissionMissing <- subset(corvettes, is.na(corvettes$Transmission))
trans <- corvettes$Transmission
transmission <- data.frame(standard=length(trans[which(trans=="S")]), automatic=length(trans[which(trans=="A")]))
trans_specs <- transmission %>% mutate(
  total = sum(standard, automatic),
  standard_percent = percent(standard/total)
  )
knitr::kable(corvetteTransmissionMissing)
knitr::kable(trans_specs, col.names=c("Standard","Automatic", "Total", "Standard Percent"))
```
### Convertible
```{r corvette_convt, echo=FALSE}
corvetteConvertibleMissing <- subset(corvettes, is.na(corvettes$Convertible))
convertibles <- corvettes$Convertible
allCars <- data.frame(convertible=length(convertibles[which(convertibles=="Y")]), regular=length(convertibles[which(convertibles=="N")]))
convertibles_specs <- allCars %>% mutate(
  total = sum(convertible, regular),
  convertible_percent = percent(convertible/total)
  )
knitr::kable(convertibles_specs, col.names=c("Convertible","Regular", "Total", "Convertible Percent"))
```
### Miles
Using mean imputation in this case. Using simple rounding since the existing dataset does not have decimals.
```{r corvette_miles, echo=FALSE}
meanMiles <- round(mean(corvettes$Miles, na.rm = TRUE), 0)
print(meanMiles)
```
## Categorical Variables
Will create a new table for this so that I can substitute without altering the original table (and losing track). New table with all the changes for the remaining questions will be at the bottom of the page.
```{r categories}
## figure out what auction locations exist
auction_loc <- corvettes$Auction
unique(auction_loc, rm.na=TRUE)
## find the most frequent
names(which.max(table(auction_loc)))
```
```{r newtable, echo=FALSE}
corvettes_new <- corvettes
corvettes_new$auc_louisville <- ifelse(corvettes_new$Auction == "Louisville", 1, 0)
corvettes_new$auc_kc <- ifelse(corvettes_new$Auction == "Kansas City", 1, 0)
corvettes_new$auc_monterey <- ifelse(corvettes_new$Auction == "Monterey", 1, 0)
corvettes_new <- na.omit(corvettes_new %>% mutate_at(vars("Transmission"), ~replace_na(., "S")) 
                         %>% mutate_at(vars("Miles"), ~replace_na(., meanMiles))
                         %>% mutate_at(vars("Transmission"), funs(ifelse(. == "S", 1, 0)))
                         %>% mutate_at(vars("Convertible"), funs(ifelse(. == "Y", 1, 0)))
                         )
## sorting the table by Auction house
knitr::kable(corvettes_new[order(corvettes_new$Auction, decreasing=FALSE),])
```